# シート構造詳細設計書

この文書は、代替機管理システムの各 Google Sheets シートの詳細な構造を定義します。

## 1. マスタシート構造

### 1.1 端末マスタ

#### 概要

端末機器（Server、Desktop、Laptop、Tablet）の管理情報を格納するマスタシート。

#### 列構造

| 列番号 | 列名             | データ型 | 必須 | 説明                                     | 例                            |
| ------ | ---------------- | -------- | ---- | ---------------------------------------- | ----------------------------- |
| A      | 拠点管理番号     | String   | ✓    | 機器固有識別子                           | OSAKA_SV_ThinkPad_ABC123_001  |
| B      | カテゴリ         | String   | ✓    | 機器分類（Server/Desktop/Laptop/Tablet） | Server                        |
| C      | 機種名           | String   | ✓    | 機種マスタから選択                       | ThinkPad X1 Carbon            |
| D      | 担当者           | String   |      | 管理担当者名                             | 山田太郎                      |
| E      | 資産管理番号     | String   |      | 会社の資産番号                           | ASSET_001                     |
| F      | 製造番号         | String   | ✓    | シリアルナンバー                         | ABC123456                     |
| G      | ソフトウェア     | String   |      | インストールソフト                       | Office 2021                   |
| H      | OS               | String   |      | オペレーティングシステム                 | Windows 11                    |
| I      | formURL          | String   |      | 個別フォーム URL                         | https://forms.google.com/...  |
| J      | 共通フォーム URL | String   |      | 共通フォーム URL                         | https://forms.google.com/...  |
| K      | QR コード URL    | String   |      | QR コード用 URL                          | https://script.google.com/... |

#### 制約・ルール

- **拠点管理番号**: システム全体で一意、5 セクション構成
- **カテゴリ**: Server, Desktop, Laptop, Tablet のみ有効
- **機種名**: 機種マスタに存在する機種名のみ
- **代替機種別**: SV（Server）、CL（Client）の分類
- **URL フィールド**: HTTP/HTTPS 形式、自動生成

### 1.2 プリンタマスタ

#### 概要

プリンタ機器の管理情報を格納するマスタシート。

#### 列構造

| 列番号 | 列名             | データ型 | 必須 | 説明                     | 例                            |
| ------ | ---------------- | -------- | ---- | ------------------------ | ----------------------------- |
| A      | 拠点管理番号     | String   | ✓    | 機器固有識別子           | OSAKA_Printer_MFP_XYZ123_001  |
| B      | カテゴリ         | String   | ✓    | 機器分類（Printer 固定） | Printer                       |
| C      | 機種名           | String   | ✓    | 機種マスタから選択       | imageCLASS MF644Cdw           |
| D      | 製造番号         | String   | ✓    | シリアルナンバー         | XYZ123456                     |
| E      | 代替機種別       | String   |      | 代替機のカテゴリ分類     | プリンタ                      |
| F      | formURL          | String   |      | 個別フォーム URL         | https://forms.google.com/...  |
| G      | 共通フォーム URL | String   |      | 共通フォーム URL         | https://forms.google.com/...  |
| H      | QR コード URL    | String   |      | QR コード用 URL          | https://script.google.com/... |

#### 制約・ルール

- **拠点管理番号**: システム全体で一意、5 セクション構成
- **カテゴリ**: Printer 固定
- **機種名**: 機種マスタに存在する機種名のみ
- **代替機種別**: プリンタ固定
- **URL フィールド**: HTTP/HTTPS 形式、自動生成

### 1.3 その他マスタ

#### 概要

Router、Hub、その他機器の管理情報を格納するマスタシート。

#### 列構造

| 列番号 | 列名             | データ型 | 必須 | 説明                         | 例                            |
| ------ | ---------------- | -------- | ---- | ---------------------------- | ----------------------------- |
| A      | 拠点管理番号     | String   | ✓    | 機器固有識別子               | OSAKA_Router_WXR_DEF789_001   |
| B      | カテゴリ         | String   | ✓    | 機器分類（Router/Hub/Other） | Router                        |
| C      | 機種名           | String   | ✓    | 機種マスタから選択           | WXR-6000AX12S                 |
| D      | 製造番号         | String   | ✓    | シリアルナンバー             | DEF789456                     |
| E      | 代替機種別       | String   |      | 代替機のカテゴリ分類         | その他                        |
| F      | formURL          | String   |      | 個別フォーム URL             | https://forms.google.com/...  |
| G      | 共通フォーム URL | String   |      | 共通フォーム URL             | https://forms.google.com/...  |
| H      | QR コード URL    | String   |      | QR コード用 URL              | https://script.google.com/... |

#### 制約・ルール

- **拠点管理番号**: システム全体で一意、5 セクション構成
- **カテゴリ**: Router, Hub, Other のみ有効
- **機種名**: 機種マスタに存在する機種名のみ
- **代替機種別**: その他固定
- **URL フィールド**: HTTP/HTTPS 形式、自動生成

### 1.4 拠点マスタ

#### 概要

拠点情報と管轄情報を管理するマスタシート。

#### 列構造

| 列番号 | 列名                   | データ型 | 必須 | 説明                           | 例                     |
| ------ | ---------------------- | -------- | ---- | ------------------------------ | ---------------------- |
| A      | 拠点 ID                | String   | ✓    | 拠点識別子（小文字英数字）     | osaka                  |
| B      | 拠点名                 | String   | ✓    | 拠点の正式名称                 | 大阪営業所             |
| C      | 拠点コード             | String   | ✓    | 拠点管理番号用コード（大文字） | OSAKA                  |
| D      | 管轄                   | String   | ✓    | 管轄エリア                     | 関西                   |
| E      | グループメールアドレス | Email    | ✓    | 課のグループメール             | test-group@example.com |
| F      | ステータス変更通知     | Boolean  | ✓    | 通知 ON/OFF                    | true                   |
| G      | ステータス             | String   | ✓    | 有効/無効                      | active                 |
| H      | 作成日                 | DateTime | ✓    | レコード作成日時               | 2024/07/02 14:30:00    |
| I      | 更新日                 | DateTime | ✓    | 最終更新日時                   | 2024/07/02 14:30:00    |

#### 制約・ルール

- **拠点 ID**: 小文字英数字のみ、20 文字以内、ユニーク
- **拠点コード**: 大文字英語のみ、20 文字以内、ユニーク
- **管轄**: 自由入力（関西、関東、九州等）
- **グループメールアドレス**: メール形式バリデーション
- **ステータス変更通知**: true/false、デフォルト false
- **ステータス**: active/inactive
- **日時フィールド**: yyyy/MM/dd HH:mm:ss 形式

### 1.5 機種マスタ

#### 概要

機器の機種情報を管理するマスタシート。

#### 列構造

| 列番号 | 列名     | データ型 | 必須 | 説明                               | 例                  |
| ------ | -------- | -------- | ---- | ---------------------------------- | ------------------- |
| A      | 機種 ID  | String   | ✓    | 自動生成 ID                        | MODEL_001           |
| B      | 機種名   | String   | ✓    | 機種の正式名称（ハイフン使用推奨） | ThinkPad-X1-Carbon  |
| C      | メーカー | String   | ✓    | 製造メーカー名                     | Lenovo              |
| D      | カテゴリ | String   | ✓    | 機器カテゴリ（頭文字大文字）       | Desktop             |
| E      | 作成日   | DateTime | ✓    | レコード作成日時                   | 2024/07/02 14:30:00 |
| F      | 更新日   | DateTime | ✓    | 最終更新日時                       | 2024/07/02 14:30:00 |
| G      | 備考     | String   |      | 補足情報                           | 第 10 世代          |

#### 制約・ルール

- **機種 ID**: 自動生成、ユニーク
- **機種名**: スペース禁止、ハイフン使用、アンダースコア禁止
- **カテゴリ**: Desktop, Laptop, Server, Tablet, Printer, Router, Hub, Other
- **日時フィールド**: yyyy/MM/dd HH:mm:ss 形式

#### カテゴリマスタ

| カテゴリ（英語） | カテゴリ（日本語） | 説明                       |
| ---------------- | ------------------ | -------------------------- |
| Desktop          | デスクトップ PC    | デスクトップコンピュータ   |
| Laptop           | ノート PC          | ノートパソコン             |
| Server           | サーバー           | サーバー機器               |
| Tablet           | タブレット         | タブレット端末             |
| Printer          | プリンタ           | プリンター機器             |
| Router           | ルーター           | ネットワークルーター       |
| Hub              | ハブ               | ネットワークハブ・スイッチ |
| Other            | その他             | その他機器                 |

## 2. ステータス収集シート構造

### 2.1 端末ステータス収集

#### 概要

Google Forms から端末に関する回答を直接受信するシート。onFormSubmit トリガーが設定され、回答受信時に通知処理を実行。

#### 列構造

| 列番号 | 列名                                       | データ型 | 説明                         | 例                           |
| ------ | ------------------------------------------ | -------- | ---------------------------- | ---------------------------- |
| A      | タイムスタンプ                             | DateTime | フォーム送信日時（自動記録） | 2024/07/02 14:30:00          |
| B      | 9999.管理 ID                               | String   | 内部管理用 ID                | MGMT_001                     |
| C      | 0-0.拠点管理番号                           | String   | 機器固有識別子               | OSAKA_SV_ThinkPad_ABC123_001 |
| D      | 0-1.担当者                                 | String   | 担当者名                     | 山田太郎                     |
| E      | 0-2.EM システムズの社員ですか？            | String   | 社員判定                     | はい                         |
| F      | 0-3.所属会社                               | String   | 所属会社名                   | EM システムズ株式会社        |
| G      | 0-4.ステータス                             | String   | 機器の現在状態               | 1.貸出中                     |
| H      | 1-1.顧客名または貸出先                     | String   | 貸出先情報                   | ○○ 商事株式会社              |
| I      | 1-2.顧客番号                               | String   | 顧客管理番号                 | CUST_001                     |
| J      | 1-3.住所                                   | String   | 貸出先住所                   | 大阪市北区...                |
| K      | 1-4.ユーザー機の預り有無                   | String   | 預り機の有無                 | 有り                         |
| L      | 1-5.依頼者                                 | String   | 依頼者名                     | 田中花子                     |
| M      | 1-6.備考                                   | String   | 貸出時備考                   | 修理期間中の代替機           |
| N      | 1-7.預りユーザー機のシリアル No.(製造番号) | String   | 預かった機器のシリアル番号   | USER_ABC123                  |
| O      | 1-8.お預かり証 No.                         | String   | 預かり証番号                 | RECEIPT_001                  |
| P      | 2-1.預り機返却の有無                       | String   | 預り機返却状況               | 無し                         |
| Q      | 2-2.依頼者                                 | String   | 返却依頼者名                 | 佐藤次郎                     |
| R      | 2-3.備考                                   | String   | 返却時備考                   | 修理完了                     |
| S      | 3-0.社内ステータス                         | String   | 社内での状態                 | 修理中                       |
| T      | 3-0-1.棚卸しフラグ                         | String   | 棚卸し対象フラグ             | 対象                         |
| U      | 3-0-2.拠点                                 | String   | 現在の拠点                   | 大阪                         |
| V      | 3-1-1.ソフト                               | String   | ソフトウェア情報             | Office 2021                  |
| W      | 3-1-2.備考                                 | String   | ソフト関連備考               | ライセンス更新済み           |
| X      | 3-2-1.端末初期化の引継ぎ                   | String   | 初期化引継ぎ情報             | 実施済み                     |
| Y      | 3-2-2.備考                                 | String   | 初期化備考                   | データ削除確認済み           |
| Z      | 3-2-3.引継ぎ担当者                         | String   | 引継ぎ担当者名               | 鈴木三郎                     |
| AA     | 3-2-4.初期化作業の引継ぎ                   | String   | 初期化作業引継ぎ             | 完了                         |
| AB     | 4-1.所在                                   | String   | 機器の所在地                 | 本社倉庫                     |
| AC     | 4-2.持ち出し理由                           | String   | 持ち出し理由                 | 客先デモ                     |
| AD     | 4-3.備考                                   | String   | 持ち出し備考                 | 2024/07/15 返却予定          |
| AE     | 5-1.内容                                   | String   | その他内容                   | 特記事項なし                 |
| AF     | 5-2.所在                                   | String   | その他所在                   | 支店倉庫                     |
| AG     | 5-3.備考                                   | String   | その他備考                   | 要確認                       |

### 2.2 プリンタステータス収集

#### 概要

Google Forms からプリンタに関する回答を直接受信するシート。端末と同様に onFormSubmit トリガーが設定。

#### 列構造

| 列番号 | 列名                                       | データ型 | 説明                         | 例                           |
| ------ | ------------------------------------------ | -------- | ---------------------------- | ---------------------------- |
| A      | タイムスタンプ                             | DateTime | フォーム送信日時（自動記録） | 2024/07/02 14:30:00          |
| B      | 9999.管理 ID                               | String   | 内部管理用 ID                | MGMT_P001                    |
| C      | 0-0.拠点管理番号                           | String   | 機器固有識別子               | OSAKA_Printer_MFP_XYZ123_001 |
| D      | 0-1.担当者                                 | String   | 担当者名                     | 山田太郎                     |
| E      | 0-2.EM システムズの社員ですか？            | String   | 社員判定                     | はい                         |
| F      | 0-3.所属会社                               | String   | 所属会社名                   | EM システムズ株式会社        |
| G      | 0-4.ステータス                             | String   | 機器の現在状態               | 2.回収後社内保管             |
| H      | 1-1.顧客名または貸出先                     | String   | 貸出先情報                   | ○○ 商事株式会社              |
| I      | 1-2.顧客番号                               | String   | 顧客管理番号                 | CUST_001                     |
| J      | 1-3.住所                                   | String   | 貸出先住所                   | 大阪市北区...                |
| K      | 1-4.ユーザー機の預り有無                   | String   | 預り機の有無                 | 有り                         |
| L      | 1-5.依頼者                                 | String   | 依頼者名                     | 田中花子                     |
| M      | 1-6.備考                                   | String   | 貸出時備考                   | 修理期間中の代替機           |
| N      | 1-7.預りユーザー機のシリアル No.(製造番号) | String   | 預かった機器のシリアル番号   | USER_XYZ789                  |
| O      | 2-1.預り機返却の有無                       | String   | 預り機返却状況               | 無し                         |
| P      | 2-2.備考                                   | String   | 返却時備考                   | 修理完了                     |
| Q      | 2-3.修理の必要性                           | String   | 修理要否                     | 要修理                       |
| R      | 2-4.備考                                   | String   | 修理関連備考                 | トナー交換必要               |
| S      | 3-0.社内ステータス                         | String   | 社内での状態                 | 修理待ち                     |
| T      | 3-0-1.棚卸フラグ                           | String   | 棚卸し対象フラグ             | 対象                         |
| U      | 3-0-2.拠点                                 | String   | 現在の拠点                   | 大阪                         |
| V      | 3-1-1.備考                                 | String   | 社内ステータス備考           | 部品待ち                     |
| W      | 3-2-1.修理依頼の引継ぎ                     | String   | 修理引継ぎ情報               | 実施済み                     |
| X      | 3-2-2.症状                                 | String   | 故障症状                     | 印刷不良                     |
| Y      | 3-2-3.備考                                 | String   | 修理引継ぎ備考               | メーカー修理必要             |
| Z      | 4-1. 所在                                  | String   | 修理時所在地                 | 修理センター                 |
| AA     | 4-2.修理内容                               | String   | 修理内容                     | ドラム交換                   |
| AB     | 4-3.備考                                   | String   | 修理備考                     | 保証期間内                   |
| AC     | 5-1.所在                                   | String   | 持ち出し所在                 | 本社                         |
| AD     | 5-2.持ち出し理由                           | String   | 持ち出し理由                 | 客先デモ                     |
| AE     | 5-3.備考                                   | String   | 持ち出し備考                 | 2024/07/20 返却予定          |
| AF     | 6-1.所在                                   | String   | 廃棄時所在                   | 廃棄場                       |
| AG     | 6-2.依頼者                                 | String   | 廃棄依頼者                   | 管理部                       |
| AH     | 6-3.備考                                   | String   | 廃棄備考                     | 適正廃棄完了                 |
| AI     | 7-1.内容                                   | String   | その他内容                   | 特記事項なし                 |
| AJ     | 7-2.所在                                   | String   | その他所在                   | 支店倉庫                     |
| AK     | 7-3.備考                                   | String   | その他備考                   | 要確認                       |

## 3. ステータス定義

### 3.1 共通ステータス（0-4.ステータス）

| ステータス値     | 説明                     | 適用範囲               |
| ---------------- | ------------------------ | ---------------------- |
| 1.貸出中         | 顧客先に貸出している状態 | 端末・プリンタ         |
| 2.回収後社内保管 | 回収済み、社内で保管中   | 端末・プリンタ         |
| 3.社内にて保管中 | 社内での保管・管理中     | 端末・プリンタ・その他 |
| 4.社外持ち出し中 | 社外への持ち出し中       | 端末・プリンタ・その他 |
| 5.機器売却・廃棄 | 売却または廃棄済み       | 端末・プリンタ・その他 |
| 6.紛失・盗難     | 紛失または盗難発生       | 端末・プリンタ・その他 |
| 7.その他         | その他の状態             | 端末・プリンタ・その他 |

### 3.2 社内ステータス（3-0.社内ステータス）

| ステータス値 | 説明               | 適用範囲               |
| ------------ | ------------------ | ---------------------- |
| 1.修理中     | 修理作業中         | 端末・プリンタ         |
| 2.初期化中   | データ初期化作業中 | 端末                   |
| 3.設定中     | 各種設定作業中     | 端末・プリンタ         |
| 4.棚卸し対象 | 棚卸し対象機器     | 端末・プリンタ・その他 |
| 5.貸出可能   | 貸出可能状態       | 端末・プリンタ・その他 |

## 4. 注意事項

### 4.1 データ連携

- **マスタシート**: 手動入力または一括インポート
- **収集シート**: Google Forms からの自動入力のみ
- **データ同期**: マスタ → 収集シートへの参照あり、逆はなし

### 4.2 拡張性

- 各シートは必要に応じて列の追加が可能
- ステータス値は設定により追加・変更可能
- フォーム構造の変更に応じて収集シート構造も調整が必要

### 4.3 データ整合性

- 拠点管理番号はシステム全体で一意性を保つ
- 機種名は機種マスタとの整合性を保つ
- ステータス値は定義された値のみ使用

### 4.4 バックアップ・保守

- 収集シートは 3 年経過後のデータローテーション対象
- マスタシートは永続保持
- 定期的なデータ整合性チェックが推奨

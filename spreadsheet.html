<!-- spreadsheet.html - スプレッドシートビューアーページコンポーネント -->
<div id="spreadsheet" class="page-content">
  <div class="container">
    <h1>スプレッドシートビューアー</h1>
    <div id="popupMessage" class="popup-message" style="display:none;"></div>
    
    <!-- データタイプ選択（データタイプマスタから動的に読み込み） -->
    <div class="data-type-selector">
      <label for="dataType">データタイプを選択：</label>
      <select id="dataType" onchange="if(window.handleDataTypeChange) window.handleDataTypeChange()">
        <option value="">読み込み中...</option>
      </select>
    </div>
    
    <!-- 拠点選択（通常データ選択時のみ表示） -->
    <div class="location-selector" style="display: none;">
      <label for="location">拠点を選択：</label>
      <select id="location" onchange="if(window.handleLocationChange) window.handleLocationChange()">
        <option value="">拠点を選択してください</option>
      </select>
      
      <div id="deviceTypeContainer">
        <label for="deviceType">データ種別：</label>
        <select id="deviceType" onchange="if(window.handleDeviceTypeChange) window.handleDeviceTypeChange()">
          <option value="terminal">端末マスタ</option>
          <option value="printer">プリンタマスタ</option>
        </select>
      </div>
      
      <button id="refreshButton" class="refresh-button" onclick="if(window.refreshCurrentLocation) window.refreshCurrentLocation()" disabled>
        <i class="fas fa-sync-alt"></i>
        更新
      </button>
      <div id="lastUpdateTime" class="last-update-time" style="display: none;">
        <i class="fas fa-clock"></i>
        <span id="lastUpdateLocationName"></span>最終更新: <span id="lastUpdateTimeText">-</span>
      </div>
    </div>
    
    <!-- 監査データ用の詳細選択 -->
    <div class="audit-sheet-selector" style="display: none;">
      <label for="jurisdictionAudit">管轄を選択：</label>
      <select id="jurisdictionAudit" onchange="if(window.handleJurisdictionChange) window.handleJurisdictionChange('audit')">
        <option value="">管轄を選択してください</option>
      </select>
      
      <label for="auditSheet">監査シートを選択：</label>
      <select id="auditSheet" onchange="if(window.handleAuditSheetChange) window.handleAuditSheetChange()" disabled>
        <option value="">管轄を先に選択してください</option>
      </select>
      <button id="refreshAuditButton" class="refresh-button" onclick="if(window.refreshAuditData) window.refreshAuditData()" disabled>
        <i class="fas fa-sync-alt"></i>
        更新
      </button>
      <div id="lastUpdateTimeAudit" class="last-update-time" style="display: none;">
        <i class="fas fa-clock"></i>
        <span id="lastUpdateLocationNameAudit"></span>最終更新: <span id="lastUpdateTimeAuditText">-</span>
      </div>
    </div>
    
    <!-- サマリーデータ用の更新ボタン -->
    <div class="summary-refresh-selector" style="display: none;">
      <label for="jurisdictionSummary">管轄を選択：</label>
      <select id="jurisdictionSummary" onchange="if(window.handleJurisdictionChange) window.handleJurisdictionChange('summary')">
        <option value="">全管轄</option>
      </select>
      
      <button id="refreshSummaryButton" class="refresh-button" onclick="if(window.refreshSummaryData) window.refreshSummaryData()">
        <i class="fas fa-sync-alt"></i>
        更新
      </button>
      <div id="lastUpdateTimeSummary" class="last-update-time">
        <i class="fas fa-clock"></i>
        最終更新: <span id="lastUpdateTimeSummaryText">-</span>
      </div>
    </div>

    <div class="query-selector" style="display: none;">
      <label>表示内容：</label>
      <div class="radio-group">
        <label>
          <input type="radio" name="queryType" value="all" checked onchange="if(window.handleQueryChange) window.handleQueryChange()">
          一覧
        </label>
        <label>
          <input type="radio" name="queryType" value="lending" onchange="if(window.handleQueryChange) window.handleQueryChange()">
          <span title="「預りユーザー機のシリアルNo.」に内容がある場合に表示">
            貸出中(ユーザー預り機有)
          </span>
        </label>
      </div>
    </div>
    
    <div id="loading" class="loading" style="display:none;">データを読み込み中...</div>
    <div id="error" class="error"></div>
    
    <div class="table-responsive">
      <div id="tableContainer"></div>
    </div>
    
    <!-- フロート横スクロールバー -->
    <div id="floatScrollbar" class="float-scrollbar">
      <div class="float-scrollbar-inner">
        <div class="float-scrollbar-content"></div>
      </div>
      <div class="float-scrollbar-indicator"></div>
    </div>

    <div id="debug" class="debug">
      <h3>デバッグ情報 <span style="color: var(--success-color); font-size: 0.8em;">(デバッグモード: ON)</span></h3>
      <div class="debug-controls">
        <button onclick="if(window.clearDebugInfo) window.clearDebugInfo()">ログをクリア</button>
        <button onclick="if(window.exportDebugInfo) window.exportDebugInfo()">ログをエクスポート</button>
        <button onclick="if(window.toggleDebugMode) window.toggleDebugMode()">デバッグモード切替</button>
      </div>
      <pre id="debugInfo"></pre>
    </div>
  </div>
</div>

<!-- スプレッドシートページ専用の初期化スクリプト -->
<script>
  // ページが表示された時に初期化を実行
  (function() {
    console.log('Spreadsheet page initialization script loaded');
    
    // 既存のinitSpreadsheetPage関数が定義されていない場合のみ定義
    if (typeof window.initSpreadsheetPage === 'undefined') {
      window.initSpreadsheetPage = function() {
        console.log('initSpreadsheetPage called from spreadsheet.html');
        // spreadsheet-functions.htmlの関数を使用
      };
    }
  })();
</script> 
<!-- form-creator.html - フォーム作成ページ -->
<div class="form-creator-container">
  <div class="page-header">
    <h1><i class="fas fa-edit"></i> フォーム作成</h1>
    <p>拠点管理番号を基にGoogle Formsを動的に作成できます</p>
  </div>

  <!-- フォーム作成モード選択 -->
  <div class="form-type-selector">
    <div class="form-type-tabs">
      <button class="form-type-tab active" onclick="switchFormCreationMode('create')" id="create-tab">
        <i class="fas fa-plus"></i>
        新規作成
      </button>
      <button class="form-type-tab" onclick="switchFormCreationMode('manage')" id="manage-tab">
        <i class="fas fa-list"></i>
        作成済み管理
      </button>
    </div>
  </div>

  <!-- フォーム新規作成 -->
  <div id="create-form" class="form-section active">
    <div class="form-header">
      <h2><i class="fas fa-plus"></i> Google Form 新規作成</h2>
      <p>拠点管理番号を基にGoogle Formsを作成します</p>
    </div>
    
    <form class="form-creation-form" id="googleFormCreationForm">
      <!-- フォーム基本情報 -->
      <div class="form-group">
        <label for="device-type">
          <i class="fas fa-desktop"></i>
          代替機種別 <span class="required">*</span>
        </label>
        <select id="device-type" name="deviceType" required onchange="updateDeviceType()">
          <option value="">代替機種別を選択してください</option>
          <option value="terminal">端末（SV / CL）</option>
          <option value="printer">プリンタ・その他</option>
        </select>
        <small class="help-text">まず代替機の種類を選択してください</small>
      </div>

      <div class="form-group">
        <label for="location-select">
          <i class="fas fa-map-marker-alt"></i>
          拠点選択 <span class="required">*</span>
        </label>
        <select id="location-select" name="location" required onchange="updateLocationNumber()" disabled>
          <option value="">まず代替機種別を選択してください</option>
        </select>
        <small class="help-text">選択した代替機種別に応じて利用可能な拠点が表示されます</small>
      </div>

      <div class="form-group">
        <label for="location-number">
          <i class="fas fa-hashtag"></i>
          拠点管理番号 <span class="required">*</span>
        </label>
        <div class="location-number-input">
          <span id="location-prefix" class="location-prefix">選択してください_</span>
                     <input type="text" id="location-suffix" name="locationSuffix" required
                  placeholder="001" maxlength="10" disabled>
          <input type="hidden" id="location-number" name="locationNumber">
        </div>
        <small class="help-text">拠点選択後、固有の管理番号を入力してください（例: 001, 002, ABC）</small>
      </div>

      <div class="form-group">
        <label for="device-category">
          <i class="fas fa-tag"></i>
          詳細カテゴリ <span class="required">*</span>
        </label>
        <select id="device-category" name="deviceCategory" required onchange="updateDeviceCategory()" disabled>
          <option value="">拠点を選択してください</option>
        </select>
        <small class="help-text">選択した代替機種別に応じたカテゴリが表示されます</small>
      </div>

      <!-- 代替機属性情報 -->
      <div class="device-attributes-section">
        <div class="section-header">
          <h3><i class="fas fa-cogs"></i> 代替機属性設定</h3>
          <p class="section-description">代替機の詳細情報を入力してください。これらの情報がフォームに反映されます</p>
        </div>
        
        <div id="attributes-form" class="attributes-form">
          <div class="attributes-placeholder">
            <i class="fas fa-info-circle"></i>
            <p>代替機種別と拠点を選択すると、入力フィールドが表示されます</p>
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-secondary" onclick="resetFormCreation()">
          <i class="fas fa-undo"></i>
          リセット
        </button>
        <button type="submit" class="btn btn-primary">
          <i class="fas fa-magic"></i>
          フォーム作成
        </button>
      </div>
    </form>
  </div>

  <!-- 作成済みフォーム管理 -->
  <div id="manage-form" class="form-section">
    <div class="form-header">
      <h2><i class="fas fa-list"></i> 作成済みフォーム管理</h2>
      <p>作成済みのGoogle Formsを確認・管理できます</p>
    </div>
    
    <div class="forms-list-container">
      <div class="forms-list-header">
        <button type="button" class="btn btn-primary btn-sm" onclick="loadFormsList()">
          <i class="fas fa-sync"></i>
          更新
        </button>
      </div>
      
      <div id="forms-list" class="forms-list">
        <div class="loading-indicator" id="forms-loading">
          <i class="fas fa-spinner fa-spin"></i>
          読み込み中...
        </div>
      </div>
    </div>
  </div>

  <!-- 成功メッセージ -->
  <div id="success-message" class="success-message" style="display: none;">
    <i class="fas fa-check-circle"></i>
    <span id="success-text">登録が完了しました</span>
  </div>

  <!-- エラーメッセージ -->
  <div id="error-message" class="error-message" style="display: none;">
    <i class="fas fa-exclamation-triangle"></i>
    <span id="error-text">エラーが発生しました</span>
  </div>
</div> 